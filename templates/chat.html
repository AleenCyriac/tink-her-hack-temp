<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Chef Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        /* Modern formatting for the generated recipe */
        .prose h1, .prose h2 { font-weight: bold; color: #ea580c; margin-top: 1rem; }
        .prose ul { list-style-type: disc; padding-left: 1.5rem; }
        .prose ol { list-style-type: decimal; padding-left: 1.5rem; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen font-sans">

    <div class="max-w-3xl mx-auto py-12 px-4">
        <div class="text-center mb-10">
            <h1 class="text-5xl font-extrabold text-slate-900 mb-2">üç≥ AI Chef</h1>
            <p class="text-slate-600">Enter ingredients or ask "What can I cook with chicken?"</p>
        </div>

        <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-8">
            <div class="flex flex-col md:flex-row gap-4">
                <input type="text" id="ingredientInput" 
                    placeholder="e.g., chicken, garlic, pasta..." 
                    class="flex-1 px-4 py-3 rounded-xl border border-slate-300 focus:ring-2 focus:ring-orange-500 focus:outline-none">
                
                <button onclick="generateRecipe()" id="submitBtn"
                    class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-3 px-8 rounded-xl transition-all">
                    Get Recipe
                </button>
            </div>
        </div>

        <div id="loader" class="hidden text-center py-10">
            <div class="animate-spin inline-block w-8 h-8 border-4 border-orange-500 border-t-transparent rounded-full mb-2"></div>
            <p class="text-slate-500 italic">Chef is creating your menu...</p>
        </div>

        <div id="recipeCard" class="hidden bg-white rounded-2xl shadow-xl border border-slate-200 overflow-hidden">
            <div class="bg-slate-800 px-6 py-4 flex justify-between items-center">
                <h2 class="text-white font-bold text-lg">Recommended Dish</h2>
                <button onclick="clearRecipe()" class="text-slate-400 hover:text-white text-sm">Clear</button>
            </div>
            <div id="recipe-content" class="p-8 text-slate-800 leading-relaxed prose max-w-none">
            </div>
        </div>
    </div>

    <script>
       async function generateRecipe() {
    const inputField = document.getElementById('ingredientInput');
    const userMessage = inputField.value;
    const recipeCard = document.getElementById('recipeCard');
    const recipeContent = document.getElementById('recipe-content');
    const loader = document.getElementById('loader');
    const btn = document.getElementById('submitBtn');

    if (!userMessage.trim()) return;

    loader.classList.remove('hidden');
    recipeCard.classList.add('hidden');
    btn.disabled = true;

    try {
        const response = await fetch('/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ message: userMessage })
        });

        const data = await response.json();

        if (data.response) {
            recipeContent.innerHTML = marked.parse(data.response);
            recipeCard.classList.remove('hidden');
            inputField.value = "";
        }
    } catch (error) {
        alert("Error connecting to server.");
    } finally {
        loader.classList.add('hidden');
        btn.disabled = false;
    }
}


        function clearRecipe() {
            document.getElementById('recipeCard').classList.add('hidden');
        }
    </script>
</body>
</html>